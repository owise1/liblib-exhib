var _pl={db:"liblib",design:"liblib-exhib"};window.URL=window.URL||window.webkitURL;var LibLibExhibApp=angular.module("LibLibExhibApp",["CornerCouch"]).config(["$compileProvider",function(i){var n=/^\s*(https?|blob):/;i.aHrefSanitizationWhitelist(n),i.imgSrcSanitizationWhitelist(n)}]);LibLibExhibApp.controller("ListingCtrl",["$scope","$http","cornercouch",function(i,n,t){function e(i){return i._attachments&&angular.forEach(i._attachments,function(n,t){/^cover\./.test(t)?i.coverImg="/"+o.db+"/"+i._id+"/"+t:(i.media=n,i.media.url="/"+o.db+"/"+i._id+"/"+t)}),i}var o=window._pl;i.db=t().getDB(o.db),i.upload=function(n){for(var t,e=[],o=0;t=n.files[o];o++)e.push(t);e.forEach(function(n){var t=i.db.newDoc({name:n.name,content_type:n.type});t.save().success(function(){t.attach(n,n.name)})})},i.db.query(o.design,"media",{reduce:!1,limit:10,include_docs:!0}).success(function(n){i.medias=n.rows.map(e)})}]);